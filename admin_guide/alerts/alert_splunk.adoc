
== Splunk Alerts

Splunk is a software platform to search, analyze, and visualize machine-generated data gathered from websites, applications, sensors, and devices.
Prismaâ„¢ Cloud integrates with Splunk and monitors your assets and sends alerts for resource misconfigurations, compliance violations, network security risks, and anomalous user activities to Splunk.
Prisma Cloud continually scans your environment for vulnerabilities, Complience, Runtime behavior, WAAS valiolations and more. You can monitor your Prisma Cloud alerts in Splunk using a native integration.

=== Sending alerts to Splunk

Communication is based on json, *add schema*
Works for both Splunk Enterprise and Splunk Web
Thid document is relevent for compute edetion only. If you are using Prisma Cloud SAAS console, go though this document https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin/configure-external-integrations-on-prisma-cloud/integrate-prisma-cloud-with-splunk.html 

==== Set up Splunk HTTP Event Collector (HEC) to view alert notifications from Prisma Cloud in Splunk

Splunk HEC lets you send data and application events to a Splunk deployment over the HTTP and Secure HTTP (HTTPS) protocols. This helps consolidate alert notifications from Prisma Cloud in to Splunk so that your operations team can review and take action on the alerts.

[.procedure]
. To set up HEC, use instructions in https://docs.splunk.com/Documentation/Splunk/latest/Data/UsetheHTTPEventCollector[Splunk documentation].
note that the defult *source type* is *_json* 

. Select *Settings > Data inputs > HTTP Event* Collector and make sure you see HEC added in the list and that the status shows that it is *Enabled*.

==== Set up the Splunk integration in Prisma Cloud

[.procedure]
. Log in to Prisma Cloud console

. Go to Manage > Alerts > Manage

. Click on *+ Add profile* to create a dedicated alert frofile for Splunk

.. Enter a name for your alert profile

.. In *Provider*, select *Splunk*

... In *Splunk HTTP event collector URL*, enter the Enter the Splunk HEC URL that you set up earlier.

... In Custom JSON, enter the structure of the JSON payload, or use the defult JSON. 
For more details about the type of data in each field, click *Show macros*.

... Enter *Auth Token*
The integration uses token-based authentication between Prisma Cloud and Splunk to authenticate connections to Splunk HEC. A token is a 32-bit number that is presented in Splunk.

.. In *Alert triggers* section, select the triggers that you would like Splunk to be alerted by

.. Click *Send test alert* to test the connection. You can check in Splunk to see the test 

image::splunk-alert-profile.png[width=750]

// == Configuring alerts
//
// Reusable content fragment.
include::frag_config_rate.adoc[leveloffset=0]


=== Integrating Prisma Cloud with JIRA

// Reusable content fragment.
:jira_alerts:
include::frag_send_alerts.adoc[leveloffset=0]


[.task]
=== Create new alert profile

Create a new alert profile.

[.procedure]
. In *Manage > Alerts*, click *Add profile*.

. Enter a name for your alert profile.

. In *Provider*, select *JIRA*.


[.task]
=== Configure the channel

Configure the channel.

[.procedure]
. In *Base URL*, specify the location of your JIRA service.

. In *Credential*, create the credentials required to access the account.

.. Click *Add new*.

.. Select *Basic authentication*.

.. Enter a username and password.
+
NOTE: If you are using Jira Cloud, this will be an email address and API token respectively. You can generate your API token https://id.atlassian.com/manage-profile/security/api-tokens[here].

.. Click *Save*.

. In *CA certificate*, enter a copy of the CA certificate in PEM format.

. In *Project key*, enter a project key.
+
Alternatively, you can dynamically specify the project key based on a label.
When an alert fires, the project key is taken from the label of the resource that triggered the action.
To do so, click *Select labels...*, and choose a label that you know will contain the project key.
If there are no labels in the drop-down list, go to *Manage > Alerts > Alert Labels*, and define them.

. Enter an issue type.

. Enter a priority.

. Enter a comma delimited list of JIRA labels to apply to the issue.
+
You can dynamically define the list from a label.
Click *Select labels...*, and select one or more labels.

. Enter an assignee for the new issue.
+
You can dynamically define the assignee from a label.
Click *Select labels...*, and select one or more labels.

. Click *Send Test Alert* to test the connection.

// Reusable content fragment.
include::frag_config_triggers.adoc[leveloffset=0]

