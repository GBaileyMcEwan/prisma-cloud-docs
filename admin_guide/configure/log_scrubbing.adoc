== Log Scrubbing

The Runtime events may include sensitive information that's found in the running commands, such as secrets, tokens, PII or other information considered to be personal by various laws and regulations.

Using the Runtime log scrubbing capabilities, you can filter this sensitive information and ensure that it is not included in the Runtime findings (Forensics, Incidents, audits, etc.).

You can filter your Runtime sensitive data out using the automatically scrubbing capability as well as using a scrubbing custom rules. follow the documentation instructions to learn more about these two options.

Sensitive information from the WAAS logs can be scrubed as well, see xref:../waas/log_scrubbing.adoc[WAAS Log Scrubbing] to learn more.

=== Automatically scrub secrets from runtime events

To help identifing and filtering secrets that are commonly appers in the Runtime monitored commands. We added the capability to automatically scrubs sensitive known phrases and words such as "secrets", "token", etc. from your events. The detected sensitive data will be consiled from the events by `"[\\*****]"`.

NOTE: Automatically scrub secrets will be *enabled* by default when upgrading the Console.

==== Enable/Disable the automatic scrubbing:
[.procedure]
. Open the Console, and go to *Manage > General*

. Select the desired mode in the *Automatically scrub secrets from runtime events* toggle

=== Add/Edit custome scrubbing rule

To create or edit log scrubbing rules, follow the steps below: 

[.procedure]
. Open the Console, and go to *Manage > General*

. In the *Custom log scrubber* section select Runtime or WAAS

. Click on *Add rule* or select an existing rule.

. Enter the rule *Name*

. Provide match *Pattern* in the form of a regular expression (https://github.com/google/re2/wiki/Syntax[re2]), e.g. `^sessionID$`, `key-[a-zA-Z]{8,16}`

. Provide a *Placeholder* string e.g. `[scrubbed email]`

NOTE: Placeholder strings indicating the nature of the scrubbed data should be used as users will not be able to see the underlying scrubbed data.

. Click *Save*


image::./waas_log_scrubbing.png[width=700]

[NOTE]
====
[.procedure]
. Data will now be scrubbed from any Runtime and WAAS event before it is written (either to the Defender log or syslog) and sent to the console.
. The automaticlly scrubbing and custome scrubbing are independent, meaning that you can coose using wach one of them separately.
. Serverless Runtime events are nor scrubbed.
====



Explain what data will be removed, and from where - the default values
Support backward compatibility? Not supported

We scrub only new messages that are generated after enabling the toggle, messages that were generated when the toggle is off won't be scrubbed.

Describe in the release notes that the toggle is on by default and that we will scrub known phrases and words such as "secrets", "token", etc.
